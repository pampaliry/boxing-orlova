import{_ as se}from"./BCwUQ24U.js";import{f as ce,u as le,h as p,l as ie,m as ue,r as d,e as j,o as R,w as l,b as u,a as c,c as me,k as fe,d as B,t as E,_ as z}from"./CQosNRef.js";import{u as de}from"./MzDR9hvv.js";const _e={class:"text-medium-emphasis","aria-live":"polite"},pe={key:0},ve={class:"d-flex align-center mb-4"},he={class:"chart-wrap",role:"img","aria-label":"Historický priebeh BPM z WebSocketu"},be="wss://stream.binance.com:9443/ws/btcusdt@trade",b=40,P=140,ge=3,Se=12,I=800,v=180,ke=56,N=10,xe=3e4,ye=ce({__name:"WebSocketBpm",setup(X){de({title:"WS BPM – Live WebSocket demo",meta:[{name:"description",content:"Živý WebSocket graf s BPM hodnotou odvodenou z reálnych dát."}]});const m=le(),W=typeof m.public?.wsUrl=="string"?m.public.wsUrl.trim():"",_=p(W||be),r=p("disconnected"),s=p(72),g=p(72),S=I-ke,V=[60,80,100,120],U=p(null);let t;const f=[],O=S,q=p(40);let k=0,x=0,A=0;function J(){return 1/Math.max(20,q.value)}let i=null,y=null,M=0;function Y(){const e=Math.min(xe,1e3*2**M);return M=Math.min(M+1,10),e}function $(){const e=Y();r.value="connecting",y=setTimeout(D,e)}function G(e){try{return JSON.parse(e)}catch{return null}}function K(e,o){if(typeof e=="object"&&e!==null){const n=e[o];if(typeof n=="number")return n;if(typeof n=="string"){const a=Number(n);if(!Number.isNaN(a))return a}}return null}function Z(e){const o=["t","p","q","E","T"];for(const n of o){const a=K(e,n);if(a!==null)return a}return null}function Q(e){if(!Number.isFinite(e))return 72;const o=61,n=55,a=Math.abs(Math.floor(e))%o;return n+a}function T(e,o,n){return Math.min(n,Math.max(o,e))}function D(){if(_.value){r.value="connecting";try{i=new WebSocket(_.value),i.onopen=()=>{r.value="connected",M=0},i.onmessage=e=>{const o=typeof e.data=="string"?e.data:"",n=G(o);if(!n)return;const a=Z(n);if(a==null)return;const h=T(Q(a),b+5,P-5);g.value=h},i.onerror=()=>{r.value="error"},i.onclose=()=>{r.value="disconnected",F(),$()}}catch{r.value="error"}}}function F(){if(y&&(clearTimeout(y),y=null),i){try{i.close()}catch{}i=null}}function C(e){const o=T(e,b,P),n=v-2*N;return N+(1-(o-b)/(P-b))*n}function ee(){t.strokeStyle="#e5e7eb",t.lineWidth=1;for(let e=0;e<S;e+=40)t.beginPath(),t.moveTo(e+.5,0),t.lineTo(e+.5,v),t.stroke();for(let e=0;e<v;e+=40)t.beginPath(),t.moveTo(0,e+.5),t.lineTo(S,e+.5),t.stroke()}function te(){const e=S+.5;t.strokeStyle="#9ca3af",t.lineWidth=1,t.beginPath(),t.moveTo(e,N),t.lineTo(e,v-N),t.stroke(),t.fillStyle="#374151",t.font="12px system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, sans-serif",t.textAlign="left",t.textBaseline="middle",V.forEach(n=>{const a=C(n);t.strokeStyle="#d1d5db",t.beginPath(),t.moveTo(e,a),t.lineTo(e+8,a),t.stroke(),t.fillText(String(n),e+12,a)});const o=C(s.value);t.fillStyle="#16a34a",t.beginPath(),t.arc(e+10,o,4,0,Math.PI*2),t.fill()}function ne(){if(!(f.length<2)){t.strokeStyle="#16a34a",t.lineWidth=2,t.beginPath();for(let e=0;e<f.length;e++){const o=e,n=C(f[e]);e===0?t.moveTo(o,n):t.lineTo(o,n)}t.stroke()}}function oe(){t.clearRect(0,0,I,v),ee(),ne(),te()}function H(e){const o=e||performance.now();x||(x=o);const n=Math.min(.05,(o-x)/1e3);x=o;const a=Math.min(1,ge*n),h=(g.value-s.value)*a,w=Se*n,re=T(h,-w,w);s.value=T(s.value+re,b,P),A+=n;const L=J();for(;A>=L;)f.length>=O&&f.shift(),f.push(s.value),A-=L;oe(),k=requestAnimationFrame(H)}ie(()=>{const e=U.value;if(!e)return;const o=e.getContext("2d");if(o){t=o;for(let n=0;n<O;n++)f.push(s.value);k=requestAnimationFrame(H),_.value&&D()}}),ue(()=>{k&&cancelAnimationFrame(k),F()});function ae(e,o=36,n=18){return e.length<=o+n+1?e:`${e.slice(0,o)}…${e.slice(-n)}`}return(e,o)=>{const n=d("v-chip"),a=d("v-card-title"),h=d("v-card-text"),w=d("v-card");return R(),j(w,{color:"",class:"pa-6",elevation:"8",role:"region","aria-label":"Live WebSocket BPM"},{default:l(()=>[u(a,{class:"d-flex align-center justify-space-between flex-wrap"},{default:l(()=>[o[1]||(o[1]=c("span",{class:"text-h5"},"WebSocket BPM (minimal)",-1)),c("div",_e,[u(n,{color:r.value==="connected"?"green":r.value==="connecting"?"orange":r.value==="error"?"red":"grey",size:"small",class:"mr-2"},{default:l(()=>[B(E(r.value),1)]),_:1},8,["color"]),r.value!=="disconnected"?(R(),me("span",pe,[c("small",null,[o[0]||(o[0]=B("WS: ",-1)),c("code",null,E(ae(_.value)),1)])])):fe("",!0)])]),_:1}),u(h,null,{default:l(()=>[c("div",ve,[o[2]||(o[2]=c("strong",null,"BPM:",-1)),u(n,{size:"small",color:"primary",class:"ml-2"},{default:l(()=>[B(E(Math.round(s.value)),1)]),_:1})]),c("div",he,[c("canvas",{ref_key:"canvasRef",ref:U,class:"chart",width:I,height:v},null,512)])]),_:1})]),_:1})}}}),Me=z(ye,[["__scopeId","data-v-eadeb469"]]),Te={};function we(X,m){const W=d("v-card-title"),_=se,r=d("v-card-text"),s=Me,g=d("v-card");return R(),j(g,{class:"pa-8",elevation:"10","aria-label":"Zoznam projektov"},{default:l(()=>[u(W,null,{default:l(()=>[...m[0]||(m[0]=[c("h1",{class:"text-center"}," Moje Projekty ",-1)])]),_:1}),u(r,{class:""},{default:l(()=>[u(_,{href:"http://www.umy-ma.sk",target:"_blank",rel:"noopener noreferrer","aria-label":"Otvoriť projekt umy-ma.sk v novom okne"},{default:l(()=>[...m[1]||(m[1]=[B(" umy-ma.sk ",-1)])]),_:1})]),_:1}),u(s)]),_:1})}const We=z(Te,[["render",we]]);export{We as default};
